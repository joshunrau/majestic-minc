project(beast-library)

cmake_minimum_required(VERSION 2.6)

SET(BEAST_LIBRARY_PACKAGE_VERSION_MAJOR 1)
SET(BEAST_LIBRARY_PACKAGE_VERSION_MINOR 1)
SET(BEAST_LIBRARY_PACKAGE_VERSION_PATCH 0)
SET(BEAST_LIBRARY_RELEASE_DATE "20121212")

SET(BEAST_LIBRARY_VERSION_FULL "${BEAST_LIBRARY_PACKAGE_VERSION_MAJOR}.${BEAST_LIBRARY_PACKAGE_VERSION_MINOR}.${BEAST_LIBRARY_PACKAGE_VERSION_PATCH}-${BEAST_LIBRARY_RELEASE_DATE}")

SET(CPACK_PACKAGE_NAME "beast-library")
SET(CPACK_PACKAGE_DESCRIPTION_SUMMARY "Installer for the library of manually segmented brain masks")
SET(CPACK_PACKAGE_VENDOR "Brain Imaging Center, Montreal Neurological Institute, McGill University")
SET(CPACK_PACKAGE_VERSION_MAJOR ${BEAST_LIBRARY_PACKAGE_VERSION_MAJOR})
SET(CPACK_PACKAGE_VERSION_MINOR ${BEAST_LIBRARY_PACKAGE_VERSION_MINOR})
SET(CPACK_PACKAGE_VERSION_PATCH ${BEAST_LIBRARY_PACKAGE_VERSION_PATCH})
SET(CPACK_PACKAGE_CONTACT "Vladimir Fonov <vladmir.fonov@gmail.com>")
SET(CPACK_PACKAGE_INSTALL_DIRECTORY "beast-library-${BEAST_LIBRARY_VERSION_FULL}")
SET(CPACK_PACKAGE_DESCRIPTION_FILE "${CMAKE_CURRENT_SOURCE_DIR}/README.md")
SET(CPACK_RESOURCE_FILE_LICENSE    "${CMAKE_CURRENT_SOURCE_DIR}/COPYING.txt")
SET(CPACK_PACKAGE_FILE_NAME        "beast-library-${BEAST_LIBRARY_VERSION_FULL}")
SET(CPACK_DEBIAN_PACKAGE_ARCHITECTURE "all")
  
# register local modules
SET(CMAKE_MODULE_PATH "${CMAKE_MODULE_PATH}" "${CMAKE_CURRENT_SOURCE_DIR}/cmake-modules")
INCLUDE(DownloadTemplate)

# default install directories
SET(CPACK_SET_DESTDIR  ON)
SET(CPACK_PACKAGING_INSTALL_PREFIX ${CMAKE_INSTALL_PREFIX})
SET(CPACK_STRIP_FILES ON)


SET(BEAST_LIBRARY_URL "http://packages.bic.mni.mcgill.ca/tgz/beast-library-1.1.tar.gz")

DOWNLOAD_TEMPLATE(${BEAST_LIBRARY_URL} 
 "acf1807bf483c0315e1b4363e6471c47" 
 "${CMAKE_CURRENT_BINARY_DIR}/beast-library-1.1.tar.gz"  )

UNPACK_AND_INSTALL_TEMPLATE(
 "${CMAKE_CURRENT_BINARY_DIR}/beast-library-1.1.tar.gz" 
 beast-library-1.1 )

# according to http://www.cmake.org/pipermail/cmake/2011-November/047137.html it's better to put this in the end
INCLUDE(CPack)
